knitr::opts_chunk$set(echo = TRUE,
fig.align = TRUE,
fig.width = 6,
fig.height = 4)
rnorm(20, mean = 1, sd = 0)
rnorm(1, mean = 1)
rnorm(20, mean = rnorm(1, mean = 0))
rnorm(20, mean = rnorm(1, mean = 0), sd = 3)
replicate(50, rnorm(20, mean = rnorm(1, mean = 0), sd = 3))
data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 0), sd = 3)))
require(tidyverse)
require(janitor)
data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 0), sd = 3))) %>%
dplyr::bind_rows(replicate(50, rnorm(20, mean = rnorm(1, mean = 1), sd = 3))) %>%
dplyr::bind_rows(replicate(50, rnorm(20, mean = rnorm(1, mean = 2), sd = 3)))
data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 0), sd = 3))) %>%
rbind(replicate(50, rnorm(20, mean = rnorm(1, mean = 1), sd = 3))) %>%
rbind(replicate(50, rnorm(20, mean = rnorm(1, mean = 2), sd = 3)))
data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 0), sd = 3))) %>%
rbind(replicate(50, rnorm(20, mean = rnorm(1, mean = 1), sd = 3))) %>%
rbind(replicate(50, rnorm(20, mean = rnorm(1, mean = 2), sd = 3)))
data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 0), sd = 3))) %>%
rbind(data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 1), sd = 3)))) %>%
rbind(data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 2), sd = 3))))
data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 0), sd = 3))) %>%
rbind(data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 1), sd = 3)))) %>%
rbind(data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 2), sd = 3)))) %>%
clean_names()
data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 0), sd = 3))) %>%
rbind(data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 1), sd = 3)))) %>%
rbind(data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 2), sd = 3)))) %>%
clean_names() %>%
dplyr::mutate(class = ifelse(row_number() <= 20, 0,
ifelse(row_number() > 20 & row_number() <= 40, 1, 2)))
df <- data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 0), sd = 3))) %>%
rbind(data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 1), sd = 3)))) %>%
rbind(data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 2), sd = 3)))) %>%
clean_names() %>%
dplyr::mutate(class = ifelse(row_number() <= 20, 0,
ifelse(row_number() > 20 & row_number() <= 40, 1, 2)))
head(df)
prcomp(df, scale. = TRUE)
res <- prcomp(df %>%
dplyr::select(-c(class)),
scale. = TRUE)
res$x
res$x %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2, color = df$class)) +
ggthemes::scale_color_colorblind()
res$x %>%
data.frame() %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2, color = df$class)) +
ggthemes::scale_color_colorblind()
res$x %>%
data.frame() %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2, color = df$class))
df <- data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 0), sd = 3))) %>%
rbind(data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 1), sd = 3)))) %>%
rbind(data.frame(replicate(50, rnorm(20, mean = rnorm(1, mean = 2), sd = 3)))) %>%
clean_names() %>%
dplyr::mutate(class = ifelse(row_number() <= 20, "0",
ifelse(row_number() > 20 & row_number() <= 40, "1", "2")))
res <- prcomp(df %>%
dplyr::select(-c(class)),
scale. = TRUE)
res$x %>%
data.frame() %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2, color = df$class))
res$x %>%
data.frame() %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2, color = df$class)) +
ggthemes::scale_color_colorblind()
res$x %>%
data.frame() %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2, color = df$class)) +
stat_ellipse(aes(x = PC1, y = PC2, color = df$class)) +
ggthemes::scale_color_colorblind()
require(MLmetrics)
require(LICORS)
install.packages("LICORS")
require(LICORS)
km <- kmeans(df %>%
dplyr::select(-c(class)),
3)
km$cluster
orig <- res$x %>%
data.frame() %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2, color = df$class)) +
stat_ellipse(aes(x = PC1, y = PC2, color = df$class)) +
ggthemes::scale_color_colorblind()
table(df$class, km$cluster)
print(table(df$class, km$cluster))
km <- kmeans(df %>%
dplyr::select(-c(class)),
4)
print(table(df$class, km$cluster))
km <- kmeans(df %>%
dplyr::select(-c(class)),
2)
print(table(df$class, km$cluster))
print(table(df$class, km$cluster))
km <- kmeans(df %>%
dplyr::select(-c(class)),
4)
print(table(df$class, km$cluster))
res$x
km <- kmeans(
res$x %>%
dplyr::select(PC1, PC2),
3
)
km <- kmeans(
res$x %>%
data.frame() %>%
dplyr::select(PC1, PC2),
3
)
table(df$class, km$cluster)
18+19+20
57/60
km <- kmeans(df %>%
dplyr::select(-c(class)),
3)
print(table(df$class, km$cluster))
58/60
test <- scale(df %>%
dplyr::select(-c(class)))
test <- scale(df %>%
dplyr::select(-c(class))) %>%
data.frame()
sd(test$x1)
sd(test$x2)
km <- scale(df %>%
dplyr::select(-c(class))) %>%
data.frame() %>%
kmeans(
centers = 3
)
table(df$class, km$cluster)
19+18+17
54/60
res$x %>%
data.frame() %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2))
res$x %>%
data.frame() %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2, color = df$class))
res$x %>%
data.frame() %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2, color = df$class)) +
ggthemes::scale_color_colorblind()
res$x %>%
data.frame() %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2, color = df$class, shape = km$cluster)) +
ggthemes::scale_color_colorblind()
res$x %>%
data.frame() %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2, color = df$class, shape = as.character(km$cluster))) +
ggthemes::scale_color_colorblind()
res$x %>%
data.frame() %>%
ggplot() +
geom_point(aes(x = PC1, y = PC2, color = df$class, shape = as.character(km$cluster))) +
stat_ellipse(aes(x = PC1, y = PC2, color = df$class)) +
ggthemes::scale_color_colorblind()
head(res$x)
head(res$x %>%
data.frame() %>%
dplyr::select(PC1:PC10))
knitr::opts_chunk$set(echo = TRUE,
fig.align = TRUE,
fig.width = 6,
fig.height = 4,
message = FALSE,
warning = FALSE)
set.seed(123)
19+16+20
55/60
19+17+20
56/60
18+19+20
57/60
