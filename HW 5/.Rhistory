setwd("C:/Users/BDHOW/Documents/SDS-group-repo/HW 5")
knitr::opts_chunk$set(echo = TRUE,
fig.align = TRUE,
fig.width = 6,
fig.height = 4)
require(tidyverse)
require(janitor)
df <- data.frame(replicate(20, n = 1000))
head(df)
df <- data.frame(replicate(20, rnorm(n = 1000)))
head(df)
View(df)
df <- df %>%
clean_names()
head(df)
cor(df)
hist(df$x1)
require(purrr)
df %>%
reduce(function(y, x) y + ifelse(runif(1) < 0,
rnorm(1, mean = 10, sd = 2),
0) * x + rnorm(1000)) -> df$y
hist(df$y)
cord(df)
cor(df)
rowSums(df)
df %>%
dplyr::mutate(y = rowSums(.))
hist(rowSums(df))
df %>%
dplyr::mutate(y = ifelse(rowSums(.) < -7.5,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000))
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < -7.5,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000))
hist(df$y)
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 0,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000))
hist(df$y)
df <- data.frame(replicate(20, rnorm(n = 1000, mean = 50, sd = 10)))
df <- df %>%
clean_names()
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 0,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000))
hist(df$y)
df <- data.frame(replicate(20, rnorm(n = 1000, mean = 50, sd = 10)))
df <- df %>%
clean_names()
hist(df$x1)
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 42,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000))
hist(df$y)
df <- data.frame(replicate(20, rnorm(n = 1000, mean = 50, sd = 10)))
df <- df %>%
clean_names()
rowSums(df)
hist(rowSums(df))
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 975,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000))
hist(df$y)
df <- data.frame(replicate(20, rnorm(n = 1000, mean = 15, sd = 3)))
df <- df %>%
clean_names()
hist(rowSums(df))
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 285,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000))
hist(df$y)
cor(df)
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 325,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000))
hist(df$y)
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 315,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000))
hist(df)
hist(df$y)
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 325,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000))
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
hist(df$y)
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 320,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000))
hist(df$y)
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 320,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000, mean = 100, sd = 10))
hist(df$y)
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 320,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1, mean = 100, sd = 10))
hist(df$y)
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 320,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000, mean = 100, sd = 10))
hist(df$y)
df <- data.frame(replicate(20, rnorm(n = 1000, mean = 15, sd = 3)))
df <- df %>%
clean_names()
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 320,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000, mean = 100, sd = 10))
hist(df$y)
sample(nrow(df), 100)
train <- sample(nrow(df), 100)
df[train, ]
x_train <- df[train, -21]
y_train <- df[train, 21]
x_test <- df[-train, -21]
y_test <- df[train, 21]
y_test <- df[-train, 21]
set.seed(123)
df <- data.frame(replicate(20, rnorm(n = 1000, mean = 15, sd = 3)))
df <- df %>%
clean_names()
df <- df %>%
dplyr::mutate(y = ifelse(rowSums(.) < 320,
rnorm(1, mean = 5, sd = 1), 0) * rowSums(.) +
rnorm(1000, mean = 100, sd = 10))
train <- sample(nrow(df), 100)
x_train <- df[train, -21]
y_train <- df[train, 21]
x_test <- df[-train, -21]
y_test <- df[-train, 21]
require(ggthemes)
install.packages("leaps")
